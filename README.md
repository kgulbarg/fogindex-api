Middleware taken from https://github.com/ajain342/ser516-spr25-team5
